# AdvanceProfit-EA Configuration File
# Copy this to config.local.yaml and customize for your environment
# config.local.yaml is gitignored and won't be committed

# API Keys for Data Sources
data_sources:
  alpha_vantage:
    api_key: "your_key_here"
    enabled: false

  binance:
    api_key: "your_key_here"
    api_secret: "your_secret_here"
    enabled: false

  coinbase:
    api_key: "your_key_here"
    api_secret: "your_secret_here"
    enabled: false

  mt5:
    enabled: true
    login: null
    password: null
    server: null

# Model Configuration
model:
  path: "xgb_eurusd_h1.pkl"
  feature_count: 20  # H1 + H4 multi-timeframe features
  features:
    # H1 features
    - close_ema50_h1
    - ema50_ema200_h1
    - rsi_h1
    - rsi_slope_h1
    - atr_ratio_h1
    - adx_h1
    - body_h1
    - range_h1
    # Time features
    - hour
    - session
    # H1 return
    - prev_return_h1
    # H4 features
    - close_ema50_h4
    - ema50_ema200_h4
    - rsi_h4
    - rsi_slope_h4
    - atr_ratio_h4
    - adx_h4
    - body_h4
    - range_h4
    # H4 return
    - prev_return_h4
  params:
    # Default params - will be overridden by HPO
    max_depth: 3
    learning_rate: 0.05
    n_estimators: 150
    subsample: 0.8
    colsample_bytree: 0.8
    min_child_weight: 5
    reg_alpha: 1.5
    reg_lambda: 5.0
    gamma: 0.2

# Training Configuration
training:
  # Data split ratios (must sum to 1.0)
  train_ratio: 0.6      # 60% for training
  val_ratio: 0.2        # 20% for validation (HPO + early stopping)
  # Remaining 20% is holdout (never touched until final evaluation)

  # Label thresholds for classification
  buy_threshold: 0.0005   # Return > 0.05% = Buy signal
  sell_threshold: -0.0005 # Return < -0.05% = Sell signal

  # Early stopping (only used when validation set provided)
  early_stopping_rounds: 20

  # Legacy - kept for backwards compatibility
  test_size: 0.3

# Hyperparameter Optimization (Optuna)
hpo:
  enabled: true
  trials: 50            # Number of HPO trials (reduced for faster iteration)
  study_name: "xgb_hpo"
  storage: null         # Set to "sqlite:///hpo.db" to persist studies
  load_if_exists: false
  use_tscv: false       # Set true for TimeSeriesSplit within HPO
  n_splits: 3           # Number of TSCV splits if use_tscv=true

# FastAPI Server Configuration
api:
  host: "127.0.0.1"
  port: 8000
  reload: true
  workers: 1
  log_level: "info"

# Trading Configuration
trading:
  mode: "paper"  # paper or live
  symbol: "EURUSD"

  # Risk Management
  risk:
    risk_percent: 1.0
    max_daily_loss: 3.0
    max_daily_profit: 5.0
    max_simultaneous_trades: 3

  # ML Settings
  ml:
    use_predictions: true
    confidence_threshold: 0.40
    combine_with_technical: false  # true = ML + Technical, false = ML only

  # Position Management
  position:
    use_trailing_stop: true
    trailing_stop_pips: 30
    trailing_step_pips: 10
    use_breakeven: true
    breakeven_trigger_pips: 20
    breakeven_offset_pips: 5
    use_partial_close: true
    partial_close_percent: 50.0

  # Filters
  filters:
    use_time_filter: true
    start_hour: 8
    end_hour: 20
    use_volatility_filter: true
    min_atr: 0.0001
    use_trend_filter: true

# Data Collection
data_collection:
  symbol: "EURUSD"
  timeframe: "H1"  # D1, H4, H1, M15, etc.
  start_date: "2018-01-01"
  end_date: "2024-12-31"
  update_interval: "hourly"  # daily, hourly, etc.

# Backtesting
backtesting:
  initial_cash: 10000.0
  commission: 0.0001  # 0.01%
  slippage: 0.00005
  start_date: "2023-01-01"
  end_date: "2024-12-31"
  timeframe: "H1"

# Experiment Tracking (MLflow)
mlflow:
  enabled: false  # Disabled by default, enable when needed
  tracking_uri: "http://localhost:5000"
  experiment_name: "trading_bot_experiments"
  artifact_location: "./experiments"

# Logging
logging:
  level: "INFO"  # DEBUG, INFO, WARNING, ERROR, CRITICAL
  format: "%(asctime)s - %(name)s - %(levelname)s - %(message)s"
  file: "logs/trading_bot.log"
  console: true

# Notifications (optional)
notifications:
  telegram:
    enabled: false
    bot_token: "your_token_here"
    chat_id: "your_chat_id"
    send_trade_notifications: false
    send_error_notifications: true

  email:
    enabled: false
    smtp_server: "smtp.gmail.com"
    smtp_port: 587
    from_email: "your_email@gmail.com"
    password: "your_password"
    to_email: "your_email@gmail.com"

# Paths
paths:
  data_raw: "data/raw"
  data_processed: "data/processed"
  models: "models"
  logs: "logs"
  experiments: "experiments"
  notebooks: "notebooks"
  data_raw_file: "EURUSD_H1_raw.csv"
  data_processed_file: "EURUSD_H1_clean.csv"
